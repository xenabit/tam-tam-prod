var M=Object.defineProperty,$=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var z=(l,r,s)=>r in l?M(l,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[r]=s,N=(l,r)=>{for(var s in r||(r={}))F.call(r,s)&&z(l,s,r[s]);if(P)for(var s of P(r))G.call(r,s)&&z(l,s,r[s]);return l},S=(l,r)=>$(l,X(r));import{r as i,g as k,j as a}from"./vendor-Czmxryr-.js";import{u as q}from"./appstoresfirst-BZveOUVF.js";import{u as B}from"./header-CJzghuEp.js";import{u as H,p as J,a as K,b as Q,c as V,d as Z,e as tt,f as et,g as rt,h as it}from"./carousel-2hVs74sV.js";const nt="_Intro_1wzlv_2",ot="_Intro__container_1wzlv_12",at="_Intro__animals_1wzlv_28",st="_Intro__animal_1wzlv_28",_={Intro:nt,Intro__container:ot,Intro__animals:at,Intro__animal:st};function ht({id:l,isActive:r}){const s=q(),y=B(),{triggerAnimalChange:j}=H(),u=i.useMemo(()=>s||y?"mobile":"desktop",[s,y]),R=i.useRef(!1),[T,Y]=i.useState([0,1]),g=i.useRef(null),p=i.useRef(null),e=i.useRef(null),I=i.useRef(null),D=i.useRef(!1),A=i.useRef(!0),c={CENTER_PAUSE_DURATION:2,INITIAL_DELAY:.8,ENTRY_DURATION:1,EXIT_DURATION:.5,ENTRY_EASE:"elastic.out(1, 1)",EXIT_EASE:"power2.in"},x=[{img:{img:Q,avif:K,webp:J,alt:"TamTam Ягнёнок"},baseWidth:{desktop:"54vw",mobile:"92vw"},positions:{desktop:{left:{x:"-38vw",y:"23vh",rotate:17},right:{x:"38vw",y:"31vh",rotate:-16,width:"49vw"}},mobile:{left:{x:"-35vw",y:"35vh",rotate:21},right:{x:"46vw",y:"-14vh",rotate:-45}}}},{img:{img:tt,avif:Z,webp:V,alt:"TamTam Котёнок"},baseWidth:{desktop:"58vw",mobile:"97vw"},positions:{desktop:{left:{x:"-35vw",y:"39vh",rotate:9,width:"54vw"},right:{x:"40vw",y:"35vh",rotate:-20,width:"55vw"}},mobile:{left:{x:"-32vw",y:"39vh",rotate:19,width:"102vw"},right:{x:"44vw",y:"-16vh",rotate:-38}}}},{img:{img:it,avif:rt,webp:et,alt:"TamTam Щенок"},baseWidth:{desktop:"47vw",mobile:"92vw"},positions:{desktop:{left:{x:"-34vw",y:"31vh",rotate:8,width:"54vw"},right:{x:"36vw",y:"35vh",rotate:-13}},mobile:{left:{x:"-32vw",y:"39vh",rotate:19,width:"102vw"},right:{x:"44vw",y:"-16vh",rotate:-38}}}}],W={desktop:{left:{x:"-100vw",y:"100vh",rotate:15},right:{x:"100vw",y:"100vh",rotate:-18}},mobile:{left:{x:"-100vw",y:"100vh",rotate:20},right:{x:"100vw",y:"0",rotate:-20}}},b=i.useCallback((t,n)=>{var O,C,U,L;const o=u,f=(U=(C=(O=t.positions)==null?void 0:O[o])==null?void 0:C[n])==null?void 0:U.width;if(f!==void 0)return f;const h=(L=t.baseWidth)==null?void 0:L[o];return h!==void 0?h:o==="mobile"?"90vw":"50vw"},[u]),w=i.useCallback((t=T)=>{const[n,o]=t,f=x[n],h=x[o];return{left:S(N({},f),{img:f.img,width:b(f,"left"),positions:f.positions[u].left}),right:S(N({},h),{img:h.img,width:b(h,"right"),positions:h.positions[u].right})}},[T,u,b]),E=i.useCallback(()=>W[u],[u]),d=i.useCallback(()=>{if(!g.current||!p.current)return;const t=E(),n=w();k.set(g.current,{x:t.left.x,y:t.left.y,opacity:0,rotation:t.left.rotate,width:n.left.width,immediateRender:!0}),k.set(p.current,{x:t.right.x,y:t.right.y,opacity:0,rotation:t.right.rotate,width:n.right.width,immediateRender:!0})},[u,E,w]),v=i.useCallback(()=>{if(!g.current||!p.current)return null;d();const t=k.timeline({repeat:-1,paused:!0,onRepeat:()=>{Y(h=>[(h[0]+1)%x.length,(h[1]+1)%x.length]),A.current=!1}}),n=E(),o=w();t.to(g.current,{x:o.left.positions.x,y:o.left.positions.y,rotation:o.left.positions.rotate,duration:c.ENTRY_DURATION,ease:c.ENTRY_EASE,opacity:1,onStart:()=>{R.current=!1,!A.current&&!R.current&&setTimeout(()=>{j(),R.current=!0},800)}},0),t.to(p.current,{x:o.right.positions.x,y:o.right.positions.y,opacity:1,rotation:o.right.positions.rotate,duration:c.ENTRY_DURATION,ease:c.ENTRY_EASE},0);const f=c.ENTRY_DURATION+c.CENTER_PAUSE_DURATION;return t.to(g.current,{x:n.left.x,y:n.left.y,rotation:n.left.rotate,duration:c.EXIT_DURATION,ease:c.EXIT_EASE},f),t.to(p.current,{x:n.right.x,y:n.right.y,rotation:n.right.rotate,duration:c.EXIT_DURATION,ease:c.EXIT_EASE},f),t},[u,E,w,d,j]);i.useEffect(()=>{let t;return r&&g.current&&p.current?(e.current&&e.current.kill(),A.current=!0,d(),e.current=v(),t=setTimeout(()=>{e.current&&(e.current.restart(),D.current=!0)},c.INITIAL_DELAY*1e3)):(e.current&&e.current.pause(),r||d()),()=>{clearTimeout(t),e.current&&e.current.kill()}},[r,v,d]),i.useEffect(()=>{const t=()=>{I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{if(r&&e.current){const n=e.current.isActive();d(),e.current.kill(),e.current=v(),n&&e.current.restart()}else r||d()},250)};return window.addEventListener("resize",t),window.addEventListener("orientationchange",t),()=>{window.removeEventListener("resize",t),window.removeEventListener("orientationchange",t),I.current&&clearTimeout(I.current)}},[r,v,d]);const m=i.useMemo(()=>w(),[T,w]);return i.useEffect(()=>{if(e.current&&e.current.isActive()){const t=e.current.time();e.current.kill(),e.current=v();const n=e.current.duration(),o=t%n/n;e.current.progress(o),e.current.play()}},[T,v]),i.useEffect(()=>()=>{e.current&&e.current.kill(),D.current=!1},[]),a.jsx("div",{className:_.Intro,id:l,"aria-label":"Вступительная секция с анимированными питомцами",role:"region",children:a.jsxs("div",{className:_.Intro__container,children:[a.jsx("h1",{className:_.Intro__title,children:"Tam Tam Мой милый питомец"}),a.jsxs("div",{className:_.Intro__animals,"aria-live":"polite","aria-label":`Показ питомцев: ${m.left.img.alt} слева и ${m.right.img.alt} справа`,"data-orientation":y?"portrait":"landscape","data-mode":u,children:[a.jsx("div",{ref:g,className:`${_.Intro__animal} ${_.Intro__animal_left}`,"aria-hidden":"true",children:a.jsxs("picture",{children:[a.jsx("source",{type:"image/avif",srcSet:m.left.img.avif}),a.jsx("source",{type:"image/webp",srcSet:m.left.img.webp}),a.jsx("img",{src:m.left.img.img,alt:m.left.img.alt,decoding:"async",width:"100%",height:"auto","aria-hidden":"true"})]})}),a.jsx("div",{ref:p,className:`${_.Intro__animal} ${_.Intro__animal_right}`,"aria-hidden":"true",children:a.jsxs("picture",{children:[a.jsx("source",{type:"image/avif",srcSet:m.right.img.avif}),a.jsx("source",{type:"image/webp",srcSet:m.right.img.webp}),a.jsx("img",{src:m.right.img.img,alt:m.right.img.alt,decoding:"async",width:"100%",height:"auto","aria-hidden":"true"})]})})]})]})})}export{ht as I};
