var xe=Object.defineProperty,ye=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var Ce=(p,t,f)=>t in p?xe(p,t,{enumerable:!0,configurable:!0,writable:!0,value:f}):p[t]=f,K=(p,t)=>{for(var f in t||(t={}))Se.call(t,f)&&Ce(p,f,t[f]);if(we)for(var f of we(t))Ee.call(t,f)&&Ce(p,f,t[f]);return p},V=(p,t)=>ye(p,ke(t));import{r as s,g as c,j as u}from"./vendor-Czmxryr-.js";import{u as Le}from"./carousel-Dm_gxlzD.js";import{u as Ie}from"./appstoresfirst-DfM07GiT.js";const Re="/assets/images/slider-character-front-1.png",Te="/assets/images/slider-character-front-2.png",je="/assets/images/slider-character-front-3.png",Me="/assets/images/slider-character-front-1.avif",Pe="/assets/images/slider-character-front-2.avif",$e="/assets/images/slider-character-front-3.avif",Ne="/assets/images/slider-character-front-1.webp",ze="/assets/images/slider-character-front-2.webp",Be="/assets/images/slider-character-front-3.webp",De="/assets/images/slider-character-rotated-1.png",Oe="/assets/images/slider-character-rotated-2.png",Xe="/assets/images/slider-character-rotated-3.png",Ue="/assets/images/slider-character-rotated-1.avif",Ye="/assets/images/slider-character-rotated-2.avif",He="/assets/images/slider-character-rotated-3.avif",Fe="/assets/images/slider-character-rotated-1.webp",We="/assets/images/slider-character-rotated-2.webp",qe="/assets/images/slider-character-rotated-3.webp",Qe=({id:p,isActive:t})=>{const[f,G]=s.useState(0),[h,L]=s.useState(!1),[g,se]=s.useState(!1),[U,ve]=s.useState({width:typeof window!="undefined"?window.innerWidth:1600,height:typeof window!="undefined"?window.innerHeight:900}),b=Ie(),[Y,le]=s.useState({animalBg:"#80dcb0",nameBg:"#2ea56c"}),j=s.useRef(null),Q=s.useRef(null),H=s.useRef([]),I=s.useRef(null),ne=s.useRef([]),ue=s.useRef([]),{updateSliderSlide:F}=Le(),M=s.useRef(null),d=s.useRef(!1),Z=s.useRef(!1),P=s.useRef(!1),$=s.useRef(0),ae=s.useRef(!1),N=s.useRef(!1),R=s.useRef(null),A=s.useMemo(()=>[{background:"#39C883",fill:"#2EA56C",outline:"#FCCD67",backgroundBox:"#80dcb0",backgroundName:"#2ea56c"},{background:"#5b71c1",fill:"#5b71c1",outline:"#ffd26e",backgroundBox:"#b7c6f4",backgroundName:"#849adc"},{background:"#ea437b",fill:"#c41650",outline:"#f49cba",backgroundBox:"#f49cba",backgroundName:"#c41650"}],[]);s.useEffect(()=>{if(typeof window=="undefined")return;const e=()=>{ve({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);const _=s.useMemo(()=>{const e=U.width,r=1600,n=1,a=e/r*n;return Math.max(n,a)},[U.width]);s.useEffect(()=>{console.log(`Ширина: ${U.width}px, Scale factor: ${_}`)},[U.width,_]);const oe=s.useCallback(e=>e===7?"center":e>6||e===0?"next":"prev",[]),de=s.useCallback(e=>{if(!t)return;const r=ue.current[e];r&&(c.killTweensOf(r),c.fromTo(r,{scale:1},{scale:1.1,duration:.8,ease:"elastic.out(1, 0.3)",delay:0}))},[t]),fe=s.useCallback(e=>{if(!t)return;const r=ne.current[e];if(!r)return;r.innerHTML="";const n=24,a=b?100:100*_,i=b?600:600*_,l=Math.PI*(3-Math.sqrt(5)),y=c.timeline({onComplete:()=>{r.innerHTML=""}});for(let x=0;x<n;x++){const S=document.createElement("div");S.className="SliderCharacters__star-particle";const O=x%2===0,T=O?b?52:52*_:b?17:17*_,q=x*l,X=x/n,J=a+X*(i-a),w=.6+Math.random()*.4;S.style.cssText=`
        position: absolute;
        left: 50%;
        top: 50%;
        width: ${T}px;
        height: ${T}px;
        margin-left: -${T/2}px;
        margin-top: -${T/2}px;
        opacity: 0;
        transform: scale(0.3);
        will-change: transform, opacity;
        filter: drop-shadow(0 0 20px #ffbe2d) drop-shadow(0 0 80px #ffbe2d);
        pointer-events: none;
        z-index: 1000;
      `,r.appendChild(S);const o=J+(Math.random()-.5)*(J*.3),m=Math.cos(q)*o,E=Math.sin(q)*o,re=c.timeline({defaults:{ease:"linear"}});re.to(S,{opacity:1,scale:O?1.1:1.4,x:m*.5,y:E*.5,duration:w*.2}).to(S,{opacity:.8,scale:O?1:1.2,x:m*.7,y:E*.7,duration:w*.4},"0").to(S,{opacity:0,scale:0,x:m,y:E,duration:w*.4}),y.add(re,0)}const k=setTimeout(()=>{r&&(r.innerHTML="")},3e3);return()=>{y.kill(),clearTimeout(k),r&&(r.innerHTML="")}},[t]),ge=s.useCallback((e,r="slider-character")=>({id:e,name:["Бони","Барсик","Лили"][(e-1)%3],image:{front:{img:new URL(Object.assign({"/src/assets/images/slider-character-front-1.png":Re,"/src/assets/images/slider-character-front-2.png":Te,"/src/assets/images/slider-character-front-3.png":je})[`/src/assets/images/${r}-front-${e}.png`],import.meta.url).href,avif:new URL(Object.assign({"/src/assets/images/slider-character-front-1.avif":Me,"/src/assets/images/slider-character-front-2.avif":Pe,"/src/assets/images/slider-character-front-3.avif":$e})[`/src/assets/images/${r}-front-${e}.avif`],import.meta.url).href,webp:new URL(Object.assign({"/src/assets/images/slider-character-front-1.webp":Ne,"/src/assets/images/slider-character-front-2.webp":ze,"/src/assets/images/slider-character-front-3.webp":Be})[`/src/assets/images/${r}-front-${e}.webp`],import.meta.url).href},rotated:{img:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.png":De,"/src/assets/images/slider-character-rotated-2.png":Oe,"/src/assets/images/slider-character-rotated-3.png":Xe})[`/src/assets/images/${r}-rotated-${e}.png`],import.meta.url).href,avif:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.avif":Ue,"/src/assets/images/slider-character-rotated-2.avif":Ye,"/src/assets/images/slider-character-rotated-3.avif":He})[`/src/assets/images/${r}-rotated-${e}.avif`],import.meta.url).href,webp:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.webp":Fe,"/src/assets/images/slider-character-rotated-2.webp":We,"/src/assets/images/slider-character-rotated-3.webp":qe})[`/src/assets/images/${r}-rotated-${e}.webp`],import.meta.url).href}},alt:`Character ${e}`}),[]),C=s.useMemo(()=>{const e=[1,2,3].map(n=>ge(n));return[...e.map((n,a)=>V(K({},n),{id:a+1})),...e.map((n,a)=>V(K({},n),{id:a+4})),...e.map((n,a)=>V(K({},n),{id:a+7}))].map((n,a)=>V(K({},n),{initialClass:oe(a)}))},[ge,oe]),z=s.useMemo(()=>{const e={radius:700,amplitude:90,spacing:390,visibleCount:8,rotate:16};return b?{radius:600,amplitude:90,spacing:340,visibleCount:8,rotate:10}:{radius:e.radius*_,amplitude:e.amplitude*_,spacing:e.spacing*_*1.05,visibleCount:e.visibleCount,rotate:e.rotate}},[b,_]),me=s.useCallback((e,r=0)=>{const n=C.length,i=(e-r+n)%n-Math.floor(z.visibleCount/2),l=i*z.spacing,y=l*l/(4*z.radius)+z.amplitude,k=i*z.rotate,x=Math.abs(i);return{x:l,y,rotation:k,zIndex:Math.round(100-x*10)}},[C.length,z]),W=s.useCallback((e=f,r=!1)=>{if(!t)return;const n=C.length,a=4;H.current.forEach((i,l)=>{if(!i)return;const y=i.classList.contains("center");i.classList.remove("center","prev","next");let k=(l-e+n)%n;k===a?(i.classList.add("center"),r&&(!y||r==="force")&&(fe(l),setTimeout(()=>{}),de(l))):k>a?i.classList.add("next"):i.classList.add("prev")})},[f,C.length,fe,de,t]),ce=s.useCallback(e=>{t&&(le({animalBg:e.backgroundBox,nameBg:e.backgroundName}),c.to(document.documentElement,{duration:.6,ease:"linear","--current-animal-bg":e.backgroundBox,"--current-name-bg":e.backgroundName}))},[t]),v=s.useCallback((e=0,r=!1,n=!1)=>{t&&(e!==void 0&&($.current=e),H.current.forEach((a,i)=>{if(!a)return;const l=me(i,e);r||n?c.set(a,{x:l.x,y:l.y,rotate:l.rotation,zIndex:l.zIndex}):c.to(a,{duration:n?0:b?.5:1,ease:n?"none":"linear",x:l.x,y:l.y,rotate:l.rotation,zIndex:l.zIndex,overwrite:!0})}))},[me,t]),he=s.useCallback(()=>{if(!t||d.current||!Z.current||P.current)return;P.current=!0,console.log("Запуск introAnimation для активного слайдера"),I.current&&I.current.kill(),se(!0),L(!0),v(0,!0);const e=c.timeline({onStart:()=>{console.log("Начало вступительной анимации"),c.to(j.current,{opacity:1,duration:.3,ease:"power2.out",pointerEvents:"auto"}),c.to(M.current,{opacity:1,duration:1.5,ease:"linear"})},onUpdate:()=>{t&&v($.current,!1,!0)},onComplete:()=>{console.log("Анимация прокрутки завершена"),t&&(v(3,!0),c.delayedCall(.1,()=>{W(3,"force"),F(0),G(3);const n=A[0];ce(n),c.delayedCall(.1,()=>{se(!1),L(!1),d.current=!0,P.current=!1,console.log("Вступительная анимация полностью завершена")})}))}});return c.set(M.current,{opacity:0}),e.to($,{current:3,duration:b?1:1.2,ease:"power2.out",onUpdate:function(){t&&v(this.targets()[0].current,!1,!0)}}),I.current=e,()=>{I.current&&I.current.kill(),P.current=!1}},[t,A]),ee=s.useCallback((e,r="down")=>{if(!t||!Q.current)return;const n=e%3,a=A[n],i=Q.current;i.style.setProperty("--next-bg-color",a.background),i.style.setProperty("--gradient-direction",r==="down"?"to bottom":"to top"),i.style.setProperty("--bg-progress","0%"),c.fromTo(i,{"--bg-progress":"0%"},{"--bg-progress":"100%",duration:.6,ease:"linear",onComplete:()=>{i&&t&&(i.style.setProperty("--current-bg-color",a.background),i.style.setProperty("--bg-progress","0%"))}}),ce(a)},[A,ce,t]),B=s.useCallback(()=>{if(!t||h||g||!d.current)return;L(!0);const e=(f+1)%C.length,r=e%3;v(e),ee(r,"down"),F(r),c.delayedCall(b?.5:.9,()=>{t&&(G(e),W(e,!0),L(!1))})},[t,h,g,f,C.length,v,ee,F,W,d]),D=s.useCallback(()=>{if(!t||h||g||!d.current)return;L(!0);const e=(f-1+C.length)%C.length,r=e%3;v(e),ee(r,"up"),c.delayedCall(b?.2:.4,()=>{t&&F(r)}),c.delayedCall(b?.5:.9,()=>{t&&(G(e),W(e,!0),L(!1))})},[t,h,g,f,C.length,v,ee,F,W,d]),ie=s.useCallback(e=>{!t||g||h||!d.current||(e.key==="ArrowRight"?(e.preventDefault(),B()):e.key==="ArrowLeft"&&(e.preventDefault(),D()))},[t,B,D,g,h,d]),pe=s.useCallback((e,r)=>{if(!t||g||h||!d.current){e.preventDefault();return}e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),r==="next"?B():D()},[t,g,h,B,D,d]),be=s.useCallback(()=>{if(!t||g||h||!d.current)return;let e=0,r=0,n=!1;const a=50,i=30;let l=0;const y=(o,m)=>{e=o,r=m,l=Date.now(),n=!1},k=(o,m)=>{if(!e||Date.now()-l<10)return;const E=o-e,re=m-r;Math.abs(re)>i||Math.abs(E)>a&&(n=!0,E>0?D():B(),e=0,r=0)},x=o=>{n=!1,e=0,r=0},S=o=>{y(o.clientX,o.clientY)},O=o=>{!n&&e&&k(o.clientX,o.clientY)},T=o=>{x(o.clientX)},q=o=>{if(o.touches.length!==1)return;const m=o.touches[0],E=document.elementFromPoint(m.clientX,m.clientY);E&&E.closest(".SliderCharacters__navigation")||y(m.clientX,m.clientY)},X=o=>{if(o.touches.length!==1||!e)return;const m=o.touches[0];Math.abs(m.clientX-e)>10&&o.preventDefault(),k(m.clientX,m.clientY)},J=o=>{o.touches.length>0||x(o.changedTouches[0].clientX)},w=j.current;if(w)return w.addEventListener("mousedown",S),w.addEventListener("touchstart",q,{passive:!0}),w.addEventListener("touchmove",X,{passive:!1}),window.addEventListener("mousemove",O),window.addEventListener("touchmove",X,{passive:!1}),window.addEventListener("mouseup",T),window.addEventListener("touchend",J),()=>{w.removeEventListener("mousedown",S),w.removeEventListener("touchstart",q),w.removeEventListener("touchmove",X),window.removeEventListener("mousemove",O),window.removeEventListener("touchmove",X),window.removeEventListener("mouseup",T),window.removeEventListener("touchend",J)}},[t,B,D,g,h,d]),_e=s.useCallback(()=>{N.current||(N.current=!0,c.to(j.current,{opacity:.3,duration:1,ease:"power2.out",pointerEvents:"none",onComplete:()=>{R.current=setTimeout(()=>{te(),N.current=!1,ae.current=!1},300)}}),L(!0))},[]),te=s.useCallback(()=>{c.killTweensOf(H.current),c.killTweensOf($),c.killTweensOf(Q.current),c.killTweensOf(M.current),I.current&&(I.current.kill(),I.current=null),ne.current.forEach(e=>{e&&(e.innerHTML="")}),R.current&&(clearTimeout(R.current),R.current=null),G(0),L(!1),se(!1),le({animalBg:"#80dcb0",nameBg:"#2ea56c"}),d.current=!1,Z.current=!1,P.current=!1,$.current=0,N.current=!1,H.current.forEach((e,r)=>{e&&(c.set(e,{x:0,y:0,rotate:0,zIndex:100,opacity:1}),e.classList.remove("center","prev","next"),e.classList.add(oe(r)))}),M.current&&c.set(M.current,{opacity:1,clearProps:"all"}),j.current&&c.set(j.current,{opacity:1,pointerEvents:"auto",clearProps:"all"})},[]);return s.useEffect(()=>{t&&d.current&&v($.current,!1,!0)},[U.width,_,t]),s.useEffect(()=>(Z.current||(v(0,!0),Z.current=!0),t&&!d.current&&!P.current&&(R.current&&(clearTimeout(R.current),R.current=null),N.current=!1,he(),ae.current=!0),!t&&ae.current&&!N.current&&_e(),()=>{t||te()}),[t,he,te,_e]),s.useEffect(()=>(window.addEventListener("keydown",ie),()=>window.removeEventListener("keydown",ie)),[ie]),s.useEffect(()=>typeof window=="undefined"?void 0:be(),[be]),s.useEffect(()=>()=>{te()},[]),s.useEffect(()=>{document.documentElement.style.setProperty("--current-animal-bg",Y.animalBg),document.documentElement.style.setProperty("--current-name-bg",Y.nameBg)},[Y]),u.jsxs("div",{className:"SliderCharacters",ref:j,id:p,style:{opacity:0},children:[u.jsx("div",{ref:Q,className:"SliderCharacters__background","aria-hidden":"true"}),u.jsx("div",{ref:M,className:"SliderCharacters__container",children:C.map((e,r)=>u.jsxs("div",{ref:n=>H.current[r]=n,className:`SliderCharacters__item ${e.initialClass}`,style:{position:"absolute",cursor:g||!t?"default":"grab",pointerEvents:g||!t?"none":"auto"},children:[u.jsx("div",{ref:n=>ne.current[r]=n,className:"SliderCharacters__stars-explosion","aria-hidden":"true"}),u.jsxs("div",{className:"SliderCharacters__animal",children:[u.jsxs("div",{className:"SliderCharacters__pictures",children:[u.jsx("div",{className:"SliderCharacters__front",children:u.jsxs("picture",{children:[u.jsx("source",{type:"image/avif",srcSet:e.image.front.avif}),u.jsx("source",{type:"image/webp",srcSet:e.image.front.webp}),u.jsx("img",{ref:n=>ue.current[r]=n,src:e.image.front.img,width:"395",height:"395",alt:e.name,loading:r<3?"eager":"lazy",decoding:"async",style:{transformOrigin:"center bottom",display:"block",width:"100%",height:"110%",objectFit:"contain",objectPosition:"0 100%"}})]})}),u.jsx("div",{className:"SliderCharacters__rotated","aria-hidden":"true",children:u.jsxs("picture",{children:[u.jsx("source",{type:"image/avif",srcSet:e.image.rotated.avif}),u.jsx("source",{type:"image/webp",srcSet:e.image.rotated.webp}),u.jsx("img",{src:e.image.rotated.img,width:"395",height:"395",alt:e.alt,loading:"lazy",decoding:"async",draggable:"false"})]})})]}),u.jsx("div",{className:"SliderCharacters__name",children:e.name})]})]},`${e.id}-${r}`))}),u.jsxs("div",{className:"SliderCharacters__navigation",style:{opacity:g||!t?.3:1,pointerEvents:g||!t||!d.current?"none":"auto"},children:[u.jsx("button",{className:"SliderCharacters__arrow SliderCharacters__arrow_prev",onClick:e=>pe(e,"prev"),onTouchStart:e=>e.stopPropagation(),"aria-label":"Previous slide",disabled:g||h||!t||!d.current,style:{backgroundColor:Y.nameBg},children:"←"}),u.jsx("button",{className:"SliderCharacters__arrow SliderCharacters__arrow_next",onClick:e=>pe(e,"next"),onTouchStart:e=>e.stopPropagation(),"aria-label":"Next slide",disabled:g||h||!t||!d.current,style:{backgroundColor:Y.nameBg},children:"→"})]})]})};export{Qe as S};
