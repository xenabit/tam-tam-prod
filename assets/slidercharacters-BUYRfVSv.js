var xe=Object.defineProperty,ye=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var Ce=(h,t,f)=>t in h?xe(h,t,{enumerable:!0,configurable:!0,writable:!0,value:f}):h[t]=f,K=(h,t)=>{for(var f in t||(t={}))Se.call(t,f)&&Ce(h,f,t[f]);if(we)for(var f of we(t))Ee.call(t,f)&&Ce(h,f,t[f]);return h},V=(h,t)=>ye(h,ke(t));import{r as a,g as i,j as d}from"./vendor-Czmxryr-.js";import{u as Le}from"./carousel-Ce_HCjk3.js";import{u as Ie}from"./appstoresfirst-CXhrKgcP.js";const Re="/tam-tam-prod/assets/images/slider-character-front-1.png",Te="/tam-tam-prod/assets/images/slider-character-front-2.png",je="/tam-tam-prod/assets/images/slider-character-front-3.png",Me="/tam-tam-prod/assets/images/slider-character-front-1.avif",Pe="/tam-tam-prod/assets/images/slider-character-front-2.avif",$e="/tam-tam-prod/assets/images/slider-character-front-3.avif",Ne="/tam-tam-prod/assets/images/slider-character-front-1.webp",ze="/tam-tam-prod/assets/images/slider-character-front-2.webp",Be="/tam-tam-prod/assets/images/slider-character-front-3.webp",De="/tam-tam-prod/assets/images/slider-character-rotated-1.png",Oe="/tam-tam-prod/assets/images/slider-character-rotated-2.png",Xe="/tam-tam-prod/assets/images/slider-character-rotated-3.png",Ue="/tam-tam-prod/assets/images/slider-character-rotated-1.avif",Ye="/tam-tam-prod/assets/images/slider-character-rotated-2.avif",He="/tam-tam-prod/assets/images/slider-character-rotated-3.avif",We="/tam-tam-prod/assets/images/slider-character-rotated-1.webp",Fe="/tam-tam-prod/assets/images/slider-character-rotated-2.webp",qe="/tam-tam-prod/assets/images/slider-character-rotated-3.webp",Qe=({id:h,isActive:t})=>{const[f,G]=a.useState(0),[p,L]=a.useState(!1),[m,ae]=a.useState(!1),[U,ve]=a.useState({width:typeof window!="undefined"?window.innerWidth:1600,height:typeof window!="undefined"?window.innerHeight:900}),b=Ie(),[Y,le]=a.useState({animalBg:"#80dcb0",nameBg:"#2ea56c"}),j=a.useRef(null),Q=a.useRef(null),H=a.useRef([]),I=a.useRef(null),se=a.useRef([]),de=a.useRef([]),{updateSliderlSlide:W}=Le(),M=a.useRef(null),u=a.useRef(!1),Z=a.useRef(!1),P=a.useRef(!1),$=a.useRef(0),ne=a.useRef(!1),N=a.useRef(!1),R=a.useRef(null),A=a.useMemo(()=>[{background:"#39C883",fill:"#2EA56C",outline:"#FCCD67",backgroundBox:"#80dcb0",backgroundName:"#2ea56c"},{background:"#5b71c1",fill:"#5b71c1",outline:"#ffd26e",backgroundBox:"#b7c6f4",backgroundName:"#849adc"},{background:"#ea437b",fill:"#c41650",outline:"#f49cba",backgroundBox:"#f49cba",backgroundName:"#c41650"}],[]);a.useEffect(()=>{if(typeof window=="undefined")return;const e=()=>{ve({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);const _=a.useMemo(()=>{const e=U.width,r=1280,s=2560,n=.8,o=1.5;if(e<=r)return n;if(e>=s)return o;const l=o-n,w=s-r,C=(e-r)/w;return n+l*C},[U.width]);a.useEffect(()=>{console.log(`Ширина: ${U.width}px, Scale factor: ${_}`)},[U.width,_]);const oe=a.useCallback(e=>e===7?"center":e>6||e===0?"next":"prev",[]),ue=a.useCallback(e=>{if(!t)return;const r=de.current[e];r&&(i.killTweensOf(r),i.fromTo(r,{scale:1},{scale:1.1,duration:.8,ease:"elastic.out(1, 0.3)",delay:0}))},[t]),fe=a.useCallback(e=>{if(!t)return;const r=se.current[e];if(!r)return;r.innerHTML="";const s=24,n=b?100:100*_,o=b?600:600*_,l=Math.PI*(3-Math.sqrt(5)),w=i.timeline({onComplete:()=>{r.innerHTML=""}});for(let k=0;k<s;k++){const S=document.createElement("div");S.className="SliderCharacters__star-particle";const O=k%2===0,T=O?b?52:52*_:b?17:17*_,q=k*l,X=k/s,J=n+X*(o-n),v=.6+Math.random()*.4;S.style.cssText=`
        position: absolute;
        left: 50%;
        top: 50%;
        width: ${T}px;
        height: ${T}px;
        margin-left: -${T/2}px;
        margin-top: -${T/2}px;
        opacity: 0;
        transform: scale(0.3);
        will-change: transform, opacity;
        filter: drop-shadow(0 0 20px #ffbe2d) drop-shadow(0 0 80px #ffbe2d);
        pointer-events: none;
        z-index: 1000;
      `,r.appendChild(S);const c=J+(Math.random()-.5)*(J*.3),g=Math.cos(q)*c,E=Math.sin(q)*c,re=i.timeline({defaults:{ease:"linear"}});re.to(S,{opacity:1,scale:O?1.1:1.4,x:g*.5,y:E*.5,duration:v*.2}).to(S,{opacity:.8,scale:O?1:1.2,x:g*.7,y:E*.7,duration:v*.4},"0").to(S,{opacity:0,scale:0,x:g,y:E,duration:v*.4}),w.add(re,0)}const C=setTimeout(()=>{r&&(r.innerHTML="")},3e3);return()=>{w.kill(),clearTimeout(C),r&&(r.innerHTML="")}},[t]),me=a.useCallback((e,r="slider-character")=>({id:e,name:["Бони","Барсик","Лили"][(e-1)%3],image:{front:{img:new URL(Object.assign({"/src/assets/images/slider-character-front-1.png":Re,"/src/assets/images/slider-character-front-2.png":Te,"/src/assets/images/slider-character-front-3.png":je})[`/src/assets/images/${r}-front-${e}.png`],import.meta.url).href,avif:new URL(Object.assign({"/src/assets/images/slider-character-front-1.avif":Me,"/src/assets/images/slider-character-front-2.avif":Pe,"/src/assets/images/slider-character-front-3.avif":$e})[`/src/assets/images/${r}-front-${e}.avif`],import.meta.url).href,webp:new URL(Object.assign({"/src/assets/images/slider-character-front-1.webp":Ne,"/src/assets/images/slider-character-front-2.webp":ze,"/src/assets/images/slider-character-front-3.webp":Be})[`/src/assets/images/${r}-front-${e}.webp`],import.meta.url).href},rotated:{img:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.png":De,"/src/assets/images/slider-character-rotated-2.png":Oe,"/src/assets/images/slider-character-rotated-3.png":Xe})[`/src/assets/images/${r}-rotated-${e}.png`],import.meta.url).href,avif:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.avif":Ue,"/src/assets/images/slider-character-rotated-2.avif":Ye,"/src/assets/images/slider-character-rotated-3.avif":He})[`/src/assets/images/${r}-rotated-${e}.avif`],import.meta.url).href,webp:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.webp":We,"/src/assets/images/slider-character-rotated-2.webp":Fe,"/src/assets/images/slider-character-rotated-3.webp":qe})[`/src/assets/images/${r}-rotated-${e}.webp`],import.meta.url).href}},alt:`Character ${e}`}),[]),x=a.useMemo(()=>{const e=[1,2,3].map(s=>me(s));return[...e.map((s,n)=>V(K({},s),{id:n+1})),...e.map((s,n)=>V(K({},s),{id:n+4})),...e.map((s,n)=>V(K({},s),{id:n+7}))].map((s,n)=>V(K({},s),{initialClass:oe(n)}))},[me,oe]),z=a.useMemo(()=>{const e={radius:700,amplitude:90,spacing:390,visibleCount:8,rotate:16};return b?{radius:600,amplitude:90,spacing:330,visibleCount:8,rotate:10}:{radius:e.radius*_,amplitude:e.amplitude*_,spacing:e.spacing*_*1.05,visibleCount:e.visibleCount,rotate:e.rotate}},[b,_]),ge=a.useCallback((e,r=0)=>{const s=x.length,o=(e-r+s)%s-Math.floor(z.visibleCount/2),l=o*z.spacing,w=l*l/(4*z.radius)+z.amplitude,C=o*z.rotate,k=Math.abs(o);return{x:l,y:w,rotation:C,zIndex:Math.round(100-k*10)}},[x.length,z]),F=a.useCallback((e=f,r=!1)=>{if(!t)return;const s=x.length,n=4;H.current.forEach((o,l)=>{if(!o)return;const w=o.classList.contains("center");o.classList.remove("center","prev","next");let C=(l-e+s)%s;C===n?(o.classList.add("center"),r&&(!w||r==="force")&&(fe(l),setTimeout(()=>{}),ue(l))):C>n?o.classList.add("next"):o.classList.add("prev")})},[f,x.length,fe,ue,t]),ce=a.useCallback(e=>{t&&(le({animalBg:e.backgroundBox,nameBg:e.backgroundName}),i.to(document.documentElement,{duration:.6,ease:"linear","--current-animal-bg":e.backgroundBox,"--current-name-bg":e.backgroundName}))},[t]),y=a.useCallback((e=0,r=!1,s=!1)=>{t&&(e!==void 0&&($.current=e),H.current.forEach((n,o)=>{if(!n)return;const l=ge(o,e);r||s?i.set(n,{x:l.x,y:l.y,rotate:l.rotation,zIndex:l.zIndex}):i.to(n,{duration:s?0:b?.5:1,ease:s?"none":"linear",x:l.x,y:l.y,rotate:l.rotation,zIndex:l.zIndex,overwrite:!0})}))},[ge,t]),pe=a.useCallback(()=>{if(!t||u.current||!Z.current||P.current)return;P.current=!0,console.log("Запуск introAnimation для активного слайдера"),I.current&&I.current.kill(),ae(!0),L(!0),y(0,!0);const e=i.timeline({onStart:()=>{console.log("Начало вступительной анимации"),i.to(j.current,{opacity:1,duration:.3,ease:"power2.out",pointerEvents:"auto"}),i.to(M.current,{opacity:1,duration:1.5,ease:"linear"})},onUpdate:()=>{t&&y($.current,!1,!0)},onComplete:()=>{console.log("Анимация прокрутки завершена"),t&&(y(3,!0),i.delayedCall(.1,()=>{F(3,"force"),W(0),G(3);const s=A[0];ce(s),i.delayedCall(.1,()=>{ae(!1),L(!1),u.current=!0,P.current=!1,console.log("Вступительная анимация полностью завершена")})}))}});return i.set(M.current,{opacity:0}),e.to($,{current:3,duration:b?1:1.2,ease:"power2.out",onUpdate:function(){t&&y(this.targets()[0].current,!1,!0)}}),I.current=e,()=>{I.current&&I.current.kill(),P.current=!1}},[t,A]),ee=a.useCallback((e,r="down")=>{if(!t||!Q.current)return;const s=e%3,n=A[s],o=Q.current;o.style.setProperty("--next-bg-color",n.background),o.style.setProperty("--gradient-direction",r==="down"?"to bottom":"to top"),o.style.setProperty("--bg-progress","0%"),i.fromTo(o,{"--bg-progress":"0%"},{"--bg-progress":"100%",duration:.6,ease:"linear",onComplete:()=>{o&&t&&(o.style.setProperty("--current-bg-color",n.background),o.style.setProperty("--bg-progress","0%"))}}),ce(n)},[A,ce,t]),B=a.useCallback(()=>{if(!t||p||m||!u.current)return;L(!0);const e=(f+1)%x.length,r=e%3;y(e),ee(r,"down"),W(r),i.delayedCall(b?.5:.9,()=>{t&&(G(e),F(e,!0),L(!1))})},[t,p,m,f,x.length,y,ee,W,F,u]),D=a.useCallback(()=>{if(!t||p||m||!u.current)return;L(!0);const e=(f-1+x.length)%x.length,r=e%3;y(e),ee(r,"up"),i.delayedCall(b?.2:.4,()=>{t&&W(r)}),i.delayedCall(b?.5:.9,()=>{t&&(G(e),F(e,!0),L(!1))})},[t,p,m,f,x.length,y,ee,W,F,u]),ie=a.useCallback(e=>{!t||m||p||!u.current||(e.key==="ArrowRight"?(e.preventDefault(),B()):e.key==="ArrowLeft"&&(e.preventDefault(),D()))},[t,B,D,m,p,u]),he=a.useCallback((e,r)=>{if(!t||m||p||!u.current){e.preventDefault();return}e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),r==="next"?B():D()},[t,m,p,B,D,u]),be=a.useCallback(()=>{if(!t||m||p||!u.current)return;let e=0,r=0,s=!1;const n=50,o=30;let l=0;const w=(c,g)=>{e=c,r=g,l=Date.now(),s=!1},C=(c,g)=>{if(!e||Date.now()-l<10)return;const E=c-e,re=g-r;Math.abs(re)>o||Math.abs(E)>n&&(s=!0,E>0?D():B(),e=0,r=0)},k=c=>{s=!1,e=0,r=0},S=c=>{w(c.clientX,c.clientY)},O=c=>{!s&&e&&C(c.clientX,c.clientY)},T=c=>{k(c.clientX)},q=c=>{if(c.touches.length!==1)return;const g=c.touches[0],E=document.elementFromPoint(g.clientX,g.clientY);E&&E.closest(".SliderCharacters__navigation")||w(g.clientX,g.clientY)},X=c=>{if(c.touches.length!==1||!e)return;const g=c.touches[0];Math.abs(g.clientX-e)>10&&c.preventDefault(),C(g.clientX,g.clientY)},J=c=>{c.touches.length>0||k(c.changedTouches[0].clientX)},v=j.current;if(v)return v.addEventListener("mousedown",S),v.addEventListener("touchstart",q,{passive:!0}),v.addEventListener("touchmove",X,{passive:!1}),window.addEventListener("mousemove",O),window.addEventListener("touchmove",X,{passive:!1}),window.addEventListener("mouseup",T),window.addEventListener("touchend",J),()=>{v.removeEventListener("mousedown",S),v.removeEventListener("touchstart",q),v.removeEventListener("touchmove",X),window.removeEventListener("mousemove",O),window.removeEventListener("touchmove",X),window.removeEventListener("mouseup",T),window.removeEventListener("touchend",J)}},[t,B,D,m,p,u]),_e=a.useCallback(()=>{N.current||(N.current=!0,i.to(j.current,{opacity:.3,duration:1,ease:"power2.out",pointerEvents:"none",onComplete:()=>{R.current=setTimeout(()=>{te(),N.current=!1,ne.current=!1},300)}}),L(!0))},[]),te=a.useCallback(()=>{i.killTweensOf(H.current),i.killTweensOf($),i.killTweensOf(Q.current),i.killTweensOf(M.current),I.current&&(I.current.kill(),I.current=null),se.current.forEach(e=>{e&&(e.innerHTML="")}),R.current&&(clearTimeout(R.current),R.current=null),G(0),L(!1),ae(!1),le({animalBg:"#80dcb0",nameBg:"#2ea56c"}),u.current=!1,Z.current=!1,P.current=!1,$.current=0,N.current=!1,H.current.forEach((e,r)=>{e&&(i.set(e,{x:0,y:0,rotate:0,zIndex:100,opacity:1}),e.classList.remove("center","prev","next"),e.classList.add(oe(r)))}),M.current&&i.set(M.current,{opacity:1,clearProps:"all"}),j.current&&i.set(j.current,{opacity:1,pointerEvents:"auto",clearProps:"all"})},[]);return a.useEffect(()=>{t&&u.current&&y($.current,!1,!0)},[U.width,_,t]),a.useEffect(()=>(Z.current||(y(0,!0),Z.current=!0),t&&!u.current&&!P.current&&(R.current&&(clearTimeout(R.current),R.current=null),N.current=!1,pe(),ne.current=!0),!t&&ne.current&&!N.current&&_e(),()=>{t||te()}),[t,pe,te,_e]),a.useEffect(()=>(window.addEventListener("keydown",ie),()=>window.removeEventListener("keydown",ie)),[ie]),a.useEffect(()=>typeof window=="undefined"?void 0:be(),[be]),a.useEffect(()=>()=>{te()},[]),a.useEffect(()=>{document.documentElement.style.setProperty("--current-animal-bg",Y.animalBg),document.documentElement.style.setProperty("--current-name-bg",Y.nameBg)},[Y]),d.jsxs("div",{className:"SliderCharacters",ref:j,id:h,style:{opacity:0},children:[d.jsx("div",{ref:Q,className:"SliderCharacters__background","aria-hidden":"true"}),d.jsx("div",{ref:M,className:"SliderCharacters__container",children:x.map((e,r)=>d.jsxs("div",{ref:s=>H.current[r]=s,className:`SliderCharacters__item ${e.initialClass}`,style:{position:"absolute",cursor:m||!t?"default":"grab",pointerEvents:m||!t?"none":"auto"},children:[d.jsx("div",{ref:s=>se.current[r]=s,className:"SliderCharacters__stars-explosion","aria-hidden":"true"}),d.jsxs("div",{className:"SliderCharacters__animal",children:[d.jsxs("div",{className:"SliderCharacters__pictures",children:[d.jsx("div",{className:"SliderCharacters__front",children:d.jsxs("picture",{children:[d.jsx("source",{type:"image/avif",srcSet:e.image.front.avif}),d.jsx("source",{type:"image/webp",srcSet:e.image.front.webp}),d.jsx("img",{ref:s=>de.current[r]=s,src:e.image.front.img,width:"395",height:"395",alt:e.name,loading:r<3?"eager":"lazy",decoding:"async",style:{transformOrigin:"center bottom",display:"block",width:"100%",height:"110%",objectFit:"contain",objectPosition:"0 100%"}})]})}),d.jsx("div",{className:"SliderCharacters__rotated","aria-hidden":"true",children:d.jsxs("picture",{children:[d.jsx("source",{type:"image/avif",srcSet:e.image.rotated.avif}),d.jsx("source",{type:"image/webp",srcSet:e.image.rotated.webp}),d.jsx("img",{src:e.image.rotated.img,width:"395",height:"395",alt:e.alt,loading:"lazy",decoding:"async",draggable:"false"})]})})]}),d.jsx("div",{className:"SliderCharacters__name",children:e.name})]})]},`${e.id}-${r}`))}),d.jsxs("div",{className:"SliderCharacters__navigation",style:{opacity:m||!t?.3:1,pointerEvents:m||!t||!u.current?"none":"auto"},children:[d.jsx("button",{className:"SliderCharacters__arrow SliderCharacters__arrow_prev",onClick:e=>he(e,"prev"),onTouchStart:e=>e.stopPropagation(),"aria-label":"Previous slide",disabled:m||p||!t||!u.current,style:{backgroundColor:Y.nameBg},children:"←"}),d.jsx("button",{className:"SliderCharacters__arrow SliderCharacters__arrow_next",onClick:e=>he(e,"next"),onTouchStart:e=>e.stopPropagation(),"aria-label":"Next slide",disabled:m||p||!t||!u.current,style:{backgroundColor:Y.nameBg},children:"→"})]})]})};export{Qe as S};
