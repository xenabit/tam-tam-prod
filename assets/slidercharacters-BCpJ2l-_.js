var xe=Object.defineProperty,ye=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var ve=(b,t,f)=>t in b?xe(b,t,{enumerable:!0,configurable:!0,writable:!0,value:f}):b[t]=f,K=(b,t)=>{for(var f in t||(t={}))Se.call(t,f)&&ve(b,f,t[f]);if(we)for(var f of we(t))Ee.call(t,f)&&ve(b,f,t[f]);return b},V=(b,t)=>ye(b,ke(t));import{r as a,g as i,j as d}from"./vendor-Czmxryr-.js";import{u as Le}from"./carousel-DqbAfsn0.js";import{u as Ie}from"./appstoresfirst-CXhrKgcP.js";const Re="/tam-tam-prod/assets/images/slider-character-front-1.png",je="/tam-tam-prod/assets/images/slider-character-front-2.png",Te="/tam-tam-prod/assets/images/slider-character-front-3.png",Me="/tam-tam-prod/assets/images/slider-character-front-1.avif",Pe="/tam-tam-prod/assets/images/slider-character-front-2.avif",$e="/tam-tam-prod/assets/images/slider-character-front-3.avif",Ne="/tam-tam-prod/assets/images/slider-character-front-1.webp",ze="/tam-tam-prod/assets/images/slider-character-front-2.webp",Be="/tam-tam-prod/assets/images/slider-character-front-3.webp",De="/tam-tam-prod/assets/images/slider-character-rotated-1.png",Oe="/tam-tam-prod/assets/images/slider-character-rotated-2.png",Xe="/tam-tam-prod/assets/images/slider-character-rotated-3.png",Ue="/tam-tam-prod/assets/images/slider-character-rotated-1.avif",Ye="/tam-tam-prod/assets/images/slider-character-rotated-2.avif",He="/tam-tam-prod/assets/images/slider-character-rotated-3.avif",We="/tam-tam-prod/assets/images/slider-character-rotated-1.webp",Fe="/tam-tam-prod/assets/images/slider-character-rotated-2.webp",qe="/tam-tam-prod/assets/images/slider-character-rotated-3.webp",Qe=({id:b,isActive:t})=>{const[f,G]=a.useState(0),[p,E]=a.useState(!1),[m,ae]=a.useState(!1),[j,Ce]=a.useState({width:typeof window!="undefined"?window.innerWidth:1600,height:typeof window!="undefined"?window.innerHeight:900}),T=Ie(),[Y,le]=a.useState({animalBg:"#80dcb0",nameBg:"#2ea56c"}),M=a.useRef(null),Q=a.useRef(null),H=a.useRef([]),L=a.useRef(null),se=a.useRef([]),de=a.useRef([]),{updateSliderlSlide:W}=Le(),P=a.useRef(null),u=a.useRef(!1),Z=a.useRef(!1),$=a.useRef(!1),N=a.useRef(0),ne=a.useRef(!1),z=a.useRef(!1),I=a.useRef(null),A=a.useMemo(()=>[{background:"#39C883",fill:"#2EA56C",outline:"#FCCD67",backgroundBox:"#80dcb0",backgroundName:"#2ea56c"},{background:"#5b71c1",fill:"#5b71c1",outline:"#ffd26e",backgroundBox:"#b7c6f4",backgroundName:"#849adc"},{background:"#ea437b",fill:"#c41650",outline:"#f49cba",backgroundBox:"#f49cba",backgroundName:"#c41650"}],[]);a.useEffect(()=>{if(typeof window=="undefined")return;const e=()=>{Ce({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]);const h=a.useMemo(()=>{const e=j.width,r=1280,s=2560,n=.8,o=1.5;if(e<=r)return n;if(e>=s)return o;const l=o-n,_=s-r,w=(e-r)/_;return n+l*w},[j.width]);a.useEffect(()=>{console.log(`Ширина: ${j.width}px, Scale factor: ${h}`)},[j.width,h]);const oe=a.useCallback(e=>e===7?"center":e>6||e===0?"next":"prev",[]),ue=a.useCallback(e=>{if(!t)return;const r=de.current[e];r&&(i.killTweensOf(r),i.fromTo(r,{scale:1},{scale:1.1,duration:.8,ease:"elastic.out(1, 0.3)",delay:0}))},[t]),fe=a.useCallback(e=>{if(!t)return;const r=se.current[e];if(!r)return;r.innerHTML="";const s=24,n=T?100:100*h,o=T?600:600*h,l=Math.PI*(3-Math.sqrt(5)),_=i.timeline({onComplete:()=>{r.innerHTML=""}});for(let y=0;y<s;y++){const k=document.createElement("div");k.className="SliderCharacters__star-particle";const X=y%2===0,R=X?T?52:52*h:T?17:17*h,q=y*l,U=y/s,J=n+U*(o-n),v=.6+Math.random()*.4;k.style.cssText=`
        position: absolute;
        left: 50%;
        top: 50%;
        width: ${R}px;
        height: ${R}px;
        margin-left: -${R/2}px;
        margin-top: -${R/2}px;
        opacity: 0;
        transform: scale(0.3);
        will-change: transform, opacity;
        filter: drop-shadow(0 0 20px #ffbe2d) drop-shadow(0 0 80px #ffbe2d);
        pointer-events: none;
        z-index: 1000;
      `,r.appendChild(k);const c=J+(Math.random()-.5)*(J*.3),g=Math.cos(q)*c,S=Math.sin(q)*c,re=i.timeline({defaults:{ease:"linear"}});re.to(k,{opacity:1,scale:X?1.1:1.4,x:g*.5,y:S*.5,duration:v*.2}).to(k,{opacity:.8,scale:X?1:1.2,x:g*.7,y:S*.7,duration:v*.4},"0").to(k,{opacity:0,scale:0,x:g,y:S,duration:v*.4}),_.add(re,0)}const w=setTimeout(()=>{r&&(r.innerHTML="")},3e3);return()=>{_.kill(),clearTimeout(w),r&&(r.innerHTML="")}},[t]),me=a.useCallback((e,r="slider-character")=>({id:e,name:["Бони","Барсик","Лили"][(e-1)%3],image:{front:{img:new URL(Object.assign({"/src/assets/images/slider-character-front-1.png":Re,"/src/assets/images/slider-character-front-2.png":je,"/src/assets/images/slider-character-front-3.png":Te})[`/src/assets/images/${r}-front-${e}.png`],import.meta.url).href,avif:new URL(Object.assign({"/src/assets/images/slider-character-front-1.avif":Me,"/src/assets/images/slider-character-front-2.avif":Pe,"/src/assets/images/slider-character-front-3.avif":$e})[`/src/assets/images/${r}-front-${e}.avif`],import.meta.url).href,webp:new URL(Object.assign({"/src/assets/images/slider-character-front-1.webp":Ne,"/src/assets/images/slider-character-front-2.webp":ze,"/src/assets/images/slider-character-front-3.webp":Be})[`/src/assets/images/${r}-front-${e}.webp`],import.meta.url).href},rotated:{img:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.png":De,"/src/assets/images/slider-character-rotated-2.png":Oe,"/src/assets/images/slider-character-rotated-3.png":Xe})[`/src/assets/images/${r}-rotated-${e}.png`],import.meta.url).href,avif:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.avif":Ue,"/src/assets/images/slider-character-rotated-2.avif":Ye,"/src/assets/images/slider-character-rotated-3.avif":He})[`/src/assets/images/${r}-rotated-${e}.avif`],import.meta.url).href,webp:new URL(Object.assign({"/src/assets/images/slider-character-rotated-1.webp":We,"/src/assets/images/slider-character-rotated-2.webp":Fe,"/src/assets/images/slider-character-rotated-3.webp":qe})[`/src/assets/images/${r}-rotated-${e}.webp`],import.meta.url).href}},alt:`Character ${e}`}),[]),C=a.useMemo(()=>{const e=[1,2,3].map(s=>me(s));return[...e.map((s,n)=>V(K({},s),{id:n+1})),...e.map((s,n)=>V(K({},s),{id:n+4})),...e.map((s,n)=>V(K({},s),{id:n+7}))].map((s,n)=>V(K({},s),{initialClass:oe(n)}))},[me,oe]),B=a.useMemo(()=>{const e={radius:600,amplitude:90,spacing:390,visibleCount:8,rotate:16};return T?{radius:600,amplitude:90,spacing:330,visibleCount:8,rotate:10}:{radius:e.radius*h,amplitude:e.amplitude*h,spacing:e.spacing*h*1.05,visibleCount:e.visibleCount,rotate:e.rotate}},[T,h]),ge=a.useCallback((e,r=0)=>{const s=C.length,o=(e-r+s)%s-Math.floor(B.visibleCount/2),l=o*B.spacing,_=l*l/(4*B.radius)+B.amplitude,w=o*B.rotate,y=Math.abs(o);return{x:l,y:_,rotation:w,zIndex:Math.round(100-y*10)}},[C.length,B]),F=a.useCallback((e=f,r=!1)=>{if(!t)return;const s=C.length,n=4;H.current.forEach((o,l)=>{if(!o)return;const _=o.classList.contains("center");o.classList.remove("center","prev","next");let w=(l-e+s)%s;w===n?(o.classList.add("center"),r&&(!_||r==="force")&&(fe(l),ue(l))):w>n?o.classList.add("next"):o.classList.add("prev")})},[f,C.length,fe,ue,t]),ce=a.useCallback(e=>{t&&(le({animalBg:e.backgroundBox,nameBg:e.backgroundName}),i.to(document.documentElement,{duration:.6,ease:"linear","--current-animal-bg":e.backgroundBox,"--current-name-bg":e.backgroundName}))},[t]),x=a.useCallback((e=0,r=!1,s=!1)=>{t&&(e!==void 0&&(N.current=e),H.current.forEach((n,o)=>{if(!n)return;const l=ge(o,e);r||s?i.set(n,{x:l.x,y:l.y,rotate:l.rotation,zIndex:l.zIndex}):i.to(n,{duration:s?0:1,ease:s?"none":"linear",x:l.x,y:l.y,rotate:l.rotation,zIndex:l.zIndex,overwrite:!0})}))},[ge,t]),pe=a.useCallback(()=>{if(!t||u.current||!Z.current||$.current)return;$.current=!0,console.log("Запуск introAnimation для активного слайдера"),L.current&&L.current.kill(),ae(!0),E(!0),x(0,!0);const e=i.timeline({onStart:()=>{console.log("Начало вступительной анимации"),i.to(M.current,{opacity:1,duration:.3,ease:"power2.out",pointerEvents:"auto"}),i.to(P.current,{opacity:1,duration:1.5,ease:"linear"})},onUpdate:()=>{t&&x(N.current,!1,!0)},onComplete:()=>{console.log("Анимация прокрутки завершена"),t&&(x(3,!0),i.delayedCall(.1,()=>{F(3,"force"),W(0),G(3);const s=A[0];ce(s),i.delayedCall(.5,()=>{ae(!1),E(!1),u.current=!0,$.current=!1,console.log("Вступительная анимация полностью завершена")})}))}});return i.set(P.current,{opacity:0}),e.to(N,{current:3,duration:1.2,ease:"power2.out",onUpdate:function(){t&&x(this.targets()[0].current,!1,!0)}}),L.current=e,()=>{L.current&&L.current.kill(),$.current=!1}},[t,A]),ee=a.useCallback((e,r="down")=>{if(!t||!Q.current)return;const s=e%3,n=A[s],o=Q.current;o.style.setProperty("--next-bg-color",n.background),o.style.setProperty("--gradient-direction",r==="down"?"to bottom":"to top"),o.style.setProperty("--bg-progress","0%"),i.fromTo(o,{"--bg-progress":"0%"},{"--bg-progress":"100%",duration:.6,ease:"linear",onComplete:()=>{o&&t&&(o.style.setProperty("--current-bg-color",n.background),o.style.setProperty("--bg-progress","0%"))}}),ce(n)},[A,ce,t]),D=a.useCallback(()=>{if(!t||p||m||!u.current)return;E(!0);const e=(f+1)%C.length,r=e%3;x(e),ee(r,"down"),i.delayedCall(.6,()=>{t&&(G(e),W(r),F(e,!0),E(!1))})},[t,p,m,f,C.length,x,ee,W,F,u]),O=a.useCallback(()=>{if(!t||p||m||!u.current)return;E(!0);const e=(f-1+C.length)%C.length,r=e%3;x(e),ee(r,"up"),i.delayedCall(.6,()=>{t&&(G(e),W(r),F(e,!0),E(!1))})},[t,p,m,f,C.length,x,ee,W,F,u]),ie=a.useCallback(e=>{!t||m||p||!u.current||(e.key==="ArrowRight"?(e.preventDefault(),D()):e.key==="ArrowLeft"&&(e.preventDefault(),O()))},[t,D,O,m,p,u]),he=a.useCallback((e,r)=>{if(!t||m||p||!u.current){e.preventDefault();return}e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),r==="next"?D():O()},[t,m,p,D,O,u]),be=a.useCallback(()=>{if(!t||m||p||!u.current)return;let e=0,r=0,s=!1;const n=50,o=30;let l=0;const _=(c,g)=>{e=c,r=g,l=Date.now(),s=!1},w=(c,g)=>{if(!e||Date.now()-l<10)return;const S=c-e,re=g-r;Math.abs(re)>o||Math.abs(S)>n&&(s=!0,S>0?O():D(),e=0,r=0)},y=c=>{s=!1,e=0,r=0},k=c=>{_(c.clientX,c.clientY)},X=c=>{!s&&e&&w(c.clientX,c.clientY)},R=c=>{y(c.clientX)},q=c=>{if(c.touches.length!==1)return;const g=c.touches[0],S=document.elementFromPoint(g.clientX,g.clientY);S&&S.closest(".SliderCharacters__navigation")||_(g.clientX,g.clientY)},U=c=>{if(c.touches.length!==1||!e)return;const g=c.touches[0];Math.abs(g.clientX-e)>10&&c.preventDefault(),w(g.clientX,g.clientY)},J=c=>{c.touches.length>0||y(c.changedTouches[0].clientX)},v=M.current;if(v)return v.addEventListener("mousedown",k),v.addEventListener("touchstart",q,{passive:!0}),v.addEventListener("touchmove",U,{passive:!1}),window.addEventListener("mousemove",X),window.addEventListener("touchmove",U,{passive:!1}),window.addEventListener("mouseup",R),window.addEventListener("touchend",J),()=>{v.removeEventListener("mousedown",k),v.removeEventListener("touchstart",q),v.removeEventListener("touchmove",U),window.removeEventListener("mousemove",X),window.removeEventListener("touchmove",U),window.removeEventListener("mouseup",R),window.removeEventListener("touchend",J)}},[t,D,O,m,p,u]),_e=a.useCallback(()=>{z.current||(z.current=!0,i.to(M.current,{opacity:.3,duration:1,ease:"power2.out",pointerEvents:"none",onComplete:()=>{I.current=setTimeout(()=>{te(),z.current=!1,ne.current=!1},300)}}),E(!0))},[]),te=a.useCallback(()=>{i.killTweensOf(H.current),i.killTweensOf(N),i.killTweensOf(Q.current),i.killTweensOf(P.current),L.current&&(L.current.kill(),L.current=null),se.current.forEach(e=>{e&&(e.innerHTML="")}),I.current&&(clearTimeout(I.current),I.current=null),G(0),E(!1),ae(!1),le({animalBg:"#80dcb0",nameBg:"#2ea56c"}),u.current=!1,Z.current=!1,$.current=!1,N.current=0,z.current=!1,H.current.forEach((e,r)=>{e&&(i.set(e,{x:0,y:0,rotate:0,zIndex:100,opacity:1}),e.classList.remove("center","prev","next"),e.classList.add(oe(r)))}),P.current&&i.set(P.current,{opacity:1,clearProps:"all"}),M.current&&i.set(M.current,{opacity:1,pointerEvents:"auto",clearProps:"all"})},[]);return a.useEffect(()=>{t&&u.current&&(x(N.current,!1,!0),console.log(`Обновление позиций: ширина=${j.width}px, масштаб=${h}`))},[j.width,h,t]),a.useEffect(()=>(Z.current||(console.log("Инициализация позиций слайдера"),x(0,!0),Z.current=!0),t&&!u.current&&!$.current&&(console.log("Активация слайдера, запуск анимации"),I.current&&(clearTimeout(I.current),I.current=null),z.current=!1,pe(),ne.current=!0),!t&&ne.current&&!z.current&&(console.log("Начинаем процесс деактивации"),_e()),()=>{t||te()}),[t,pe,te,_e]),a.useEffect(()=>(window.addEventListener("keydown",ie),()=>window.removeEventListener("keydown",ie)),[ie]),a.useEffect(()=>typeof window=="undefined"?void 0:be(),[be]),a.useEffect(()=>()=>{te()},[]),a.useEffect(()=>{document.documentElement.style.setProperty("--current-animal-bg",Y.animalBg),document.documentElement.style.setProperty("--current-name-bg",Y.nameBg)},[Y]),d.jsxs("div",{className:"SliderCharacters",ref:M,id:b,style:{opacity:0},children:[d.jsx("div",{ref:Q,className:"SliderCharacters__background","aria-hidden":"true"}),d.jsx("div",{ref:P,className:"SliderCharacters__container",children:C.map((e,r)=>d.jsxs("div",{ref:s=>H.current[r]=s,className:`SliderCharacters__item ${e.initialClass}`,style:{position:"absolute",cursor:m||!t?"default":"grab",pointerEvents:m||!t?"none":"auto"},children:[d.jsx("div",{ref:s=>se.current[r]=s,className:"SliderCharacters__stars-explosion","aria-hidden":"true"}),d.jsxs("div",{className:"SliderCharacters__animal",children:[d.jsxs("div",{className:"SliderCharacters__pictures",children:[d.jsx("div",{className:"SliderCharacters__front",children:d.jsxs("picture",{children:[d.jsx("source",{type:"image/avif",srcSet:e.image.front.avif}),d.jsx("source",{type:"image/webp",srcSet:e.image.front.webp}),d.jsx("img",{ref:s=>de.current[r]=s,src:e.image.front.img,width:"395",height:"395",alt:e.name,loading:r<3?"eager":"lazy",decoding:"async",style:{transformOrigin:"center bottom",display:"block",width:"100%",height:"110%",objectFit:"contain",objectPosition:"0 100%"}})]})}),d.jsx("div",{className:"SliderCharacters__rotated","aria-hidden":"true",children:d.jsxs("picture",{children:[d.jsx("source",{type:"image/avif",srcSet:e.image.rotated.avif}),d.jsx("source",{type:"image/webp",srcSet:e.image.rotated.webp}),d.jsx("img",{src:e.image.rotated.img,width:"395",height:"395",alt:e.alt,loading:"lazy",decoding:"async",draggable:"false"})]})})]}),d.jsx("div",{className:"SliderCharacters__name",children:e.name})]})]},`${e.id}-${r}`))}),d.jsxs("div",{className:"SliderCharacters__navigation",style:{opacity:m||!t?.3:1,pointerEvents:m||!t||!u.current?"none":"auto"},children:[d.jsx("button",{className:"SliderCharacters__arrow SliderCharacters__arrow_prev",onClick:e=>he(e,"prev"),onTouchStart:e=>e.stopPropagation(),"aria-label":"Previous slide",disabled:m||p||!t||!u.current,style:{backgroundColor:Y.nameBg},children:"←"}),d.jsx("button",{className:"SliderCharacters__arrow SliderCharacters__arrow_next",onClick:e=>he(e,"next"),onTouchStart:e=>e.stopPropagation(),"aria-label":"Next slide",disabled:m||p||!t||!u.current,style:{backgroundColor:Y.nameBg},children:"→"})]})]})};export{Qe as S};
