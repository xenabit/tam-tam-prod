import{r as a,j as t,H as D}from"./vendor-CA5nZKRz.js";import{u as F,C as Y}from"./carousel-B7TaYoXP.js";import{u as N,F as H}from"./footer-BTmbOm63.js";import{L as O}from"./loader-DXQ32j53.js";import{I as M}from"./intro-yUbZqjKy.js";import{S as P}from"./slidercharacters-Dy4kN7JM.js";import{A as z}from"./appstoresfirst-DvSMWRjq.js";import{A as W}from"./appstoressecond-5QF73Zdd.js";import{C as q}from"./channels-BP_zenSN.js";import{N as V}from"./news-1d7TEqWG.js";import{A as $}from"./framer-motion-BHnkCE_g.js";import"./swiper-DCnd8UkD.js";function oe(){const L=a.useRef(null),h=a.useRef([]),I=a.useRef(0),i=a.useRef(!1),l=a.useRef(!1),g=a.useRef(!0),p=a.useRef(0),{setCurrentSection:b,currentSection:d,sectionConfig:j,setIsIntroSection:w}=F(),{scrollToSection:y}=N(),u=[{component:M,id:"intro"},{component:P,id:"slider"},{component:z,id:"storesFirst"},{component:Y,id:"carousel"},{component:q,id:"channels"},{component:W,id:"storesSecond"},{component:V,id:"news"},{component:H,id:"footer"}];return a.useEffect(()=>{if(window.location.hash){const r=window.location.hash.substring(1);setTimeout(()=>{y(r)},1e3)}const n=()=>{if(window.location.hash){const r=window.location.hash.substring(1);y(r)}};return window.addEventListener("hashchange",n),()=>{window.removeEventListener("hashchange",n)}},[y]),a.useEffect(()=>{var C;const n=L.current,r=j.intro,S=(C=r==null?void 0:r.scrollLockDuration)!=null?C:1500,x=setTimeout(()=>{g.current=!1},S),m=e=>{var f,v;if(e<0||e>=u.length){i.current=!1,l.current=!1;return}const o=h.current[e],c=u[e].id,s=j[c];if(!o){i.current=!1,l.current=!1;return}if(!i.current){i.current=!0,l.current=!0;try{o.scrollIntoView({behavior:"smooth"}),b(c),w(c==="intro");const E=(f=s==null?void 0:s.scrollLockDuration)!=null?f:1500;((v=s==null?void 0:s.shouldLockScroll)!=null?v:!0)&&E>0?setTimeout(()=>{i.current=!1,l.current=!1},E):(i.current=!1,l.current=!1)}catch(E){i.current=!1,l.current=!1}}},k=new IntersectionObserver(e=>{e.forEach(o=>{if(o.isIntersecting&&!i.current){const c=h.current.indexOf(o.target);c!==-1&&(b(u[c].id),w(u[c].id==="intro"))}})},{root:n,threshold:.8});h.current.forEach((e,o)=>{e&&k.observe(e)});const A=e=>{e.preventDefault();const o=Date.now();if(g.current||i.current||l.current||o-p.current<300)return;l.current=!0;const c=e.deltaY>0?1:-1,s=u.findIndex(f=>f.id===d);m(s+c),p.current=o},R=e=>{I.current=e.touches[0].clientY},T=e=>{e.preventDefault();const o=Date.now();if(g.current||i.current||o-p.current<300)return;const c=e.touches[0].clientY,s=I.current-c;if(Math.abs(s)>50){const f=u.findIndex(v=>v.id===d);s>0?m(f+1):s<0&&m(f-1),p.current=o}};return n.addEventListener("wheel",A,{passive:!1}),n.addEventListener("touchstart",R,{passive:!1}),n.addEventListener("touchmove",T,{passive:!1}),()=>{clearTimeout(x),n.removeEventListener("wheel",A),n.removeEventListener("touchstart",R),n.removeEventListener("touchmove",T),h.current.forEach(e=>{e&&k.unobserve(e)})}},[b,d,w]),t.jsxs(t.Fragment,{children:[t.jsxs(D,{children:[t.jsx("title",{children:"Тамагочи"}),t.jsx("meta",{name:"description",content:"Сайт полностью посвящен приложению И-Цзин, Канону перемен"}),t.jsx("meta",{name:"keywords",content:"Книга Перемен, И-Цзин, гадание онлайн, гексаграммы, китайская философия, канон перемен"}),t.jsx("meta",{property:"og:title",content:"Канон перемен"}),t.jsx("meta",{property:"og:description",content:"Сайт полностью посвящен приложению И-Цзин, Канону перемен"}),t.jsx("meta",{property:"og:url",content:"https://iching.laba-laba.ru/"}),t.jsx("script",{type:"application/ld+json",children:JSON.stringify({"@context":"https://schema.org","@type":"WebPage",name:"И-Цзин: Канон перемен",description:"Сайт, посвященный И-Цзину, Канону перемен, с толкованиями и мобильным приложением",url:"https://iching.laba-laba.ru/",image:"https://iching.laba-laba.ru/preview-image.jpg",publisher:{"@type":"Organization",name:"LABA",logo:{"@type":"ImageObject",url:"https://iching.laba-laba.ru/logo-laba.svg"}}})}),t.jsx("meta",{httpEquiv:"Content-Security-Policy",content:"default-src 'self'; img-src 'self' https://iching.laba-laba.ru https://mc.yandex.ru data:; script-src 'self' https://mc.yandex.ru 'sha256-GylAe+ymyzx4MREH3q81FRQ39P6rjlCCFoz0YjMxgVc='; style-src 'self' 'unsafe-inline'; font-src 'self' data:; connect-src 'self' https://mc.yandex.ru https://api.yourdomain.com; frame-src 'self' https://mc.yandex.ru;"})]}),t.jsx("main",{children:t.jsx("div",{className:"scroll-container",ref:L,children:t.jsx(a.Suspense,{fallback:t.jsx(O,{}),children:t.jsx($,{children:u.map(({component:n,id:r},S)=>{var x;return t.jsx("section",{className:"section",tabIndex:0,ref:m=>h.current[S]=m,style:{backgroundColor:((x=j[r])==null?void 0:x.background)||"#ffffff"},children:t.jsx(n,{id:r,isActive:d===r},`${r}-${d}`)},r)})})})})})]})}export{oe as default};
